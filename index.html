<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test</title>
    <link rel="stylesheet" href="main.css">
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script>
    var html = $();
    var families = {};
    $.getJSON("main.json", function(json) {
        var data = json;
        $.each(json, function(index, item){
            if ( item.docs.family !== undefined ) {
                if ( families[item.docs.family] === undefined ) {
                    families[item.docs.family] = [];
                    var $button = $('<button class="btn btn__grouped btn__super"></button>');
                    $button.text(item.docs.family);
                    $button.data('family-key', item.docs.family);
                    $button.data('index', index);
                    $button.on('focus', function(){
                        var key = $(this).data('family-key');
                        var index = $(this).data('index');
                        $('#code').empty();
                        $('#markup').empty();
                        $.each(families[key], function(index, item){
                            var componentName = item.docs.name;
                            $('#code').append($('<div>').text(item.code).html());
                            $.each(item.docs.patterns, function(index, item){
                                if ( item.markup !== undefined ) {
                                    $('#markup').append('<div class="content_bar"></div><br><h1 class="h2">'+componentName+': '+item.name+'</h1><br>');
                                    $('#markup').append(item.markup);
                                    $('#markup').append('<pre><code id="pattern-markup" class="language-markup">'+$('<div>').text(item.markup).html()+'</code></pre>');
                                    $('#markup').append('<br>');
                                }
                            });
                            console.log(item);
                            Prism.highlightAll();
                        });
                        console.log('=============');
                    });
                    html = html.add($('<li class="list_item">').append($button));
                    families[item.docs.family].push(item);
                } else {
                    families[item.docs.family].push(item);
                }
            }
        });
        $('#nav').append(html);
    });
    </script>
    <link rel="stylesheet" href="prism.css">
    <script src="prism.js"></script>
    <style>
        .language-markup {
            margin-top: 2em !important;
        }
        #nav .btn {
            margin-bottom: 1px;
        }
    </style>
</head>
<body>
    <div class="content-l_col content-l_col-1">
        <div class="content-l">
            <div class="content-l_col content-l_col-1">
                <ul class="list list__horizontal"
                    id="nav">
                </ul>
            </div>
        </div>
        <div class="content-l">
            <div class="content-l_col content-l_col-1-2">
                <div id="markup"></div>
            </div>
            <div class="content-l_col content-l_col-1-2">
                <pre><code id="code" class="language-css"></code></pre>
            </div>
        </div>
    </div>
</body>
</html>
