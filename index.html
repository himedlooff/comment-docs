<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test</title>
    <link rel="stylesheet" href="main.css">
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script>
    var html = $();
    var families = {};
    $.getJSON("meta.json", function(json) {
        var data = json;
        $.each(json, function(index, item){
            if ( item.docs.family !== undefined ) {
                if ( families[item.docs.family] === undefined ) {
                    families[item.docs.family] = [];
                    var $button = $('<button class="btn btn__link"></button>');
                    $button.text(item.docs.family);
                    $button.data('family-key', item.docs.family);
                    $button.data('index', index);
                    $button.on('focus', function(){
                        var key = $(this).data('family-key');
                        var index = $(this).data('index');
                        $('#code').empty();
                        $('#markup').empty();
                        $.each(families[key], function(index, item){
                            var componentName = item.docs.name;
                            $('#code').append(item.code);
                            $.each(item.docs.patterns, function(index, item){
                                if ( item.markup !== undefined ) {
                                    $('#markup').append('<h1 class="h2">'+componentName+': '+item.name+'</h1><br>');
                                    $('#markup').append(item.markup);
                                    $('#markup').append('<pre><code id="pattern-markup" class="language-markup">'+$('<div>').text(item.markup).html()+'</code></pre>');
                                    $('#markup').append('<br><br>');
                                }
                            });
                            console.log(item);
                            Prism.highlightAll();
                        });
                        console.log('=============');
                    });
                    html = html.add($('<li class="list_item">').append($button));
                    families[item.docs.family].push(item);
                } else {
                    families[item.docs.family].push(item);
                }
            }
        });
        $('#nav').append(html);
    });
    </script>
    <link rel="stylesheet" href="prism.css">
    <script src="prism.js"></script>
    <style>
        #pattern-markup,
        #code {
            font-size: 10px;
        }
    </style>
</head>
<body style="padding:2em;">
    <div class="content content__1-3">
        <div class="content_sidebar">
            <ul class="list list__unstyled"
                id="nav">
            </ul>
        </div>
        <div class="content_main">
            <div class="content-l">
                <div class="content-l_col content-l_col-1-2">
                    <div id="markup"></div>
                </div>
                <div class="content-l_col content-l_col-1-2">
                    <pre><code id="code" class="language-css"></code></pre>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
